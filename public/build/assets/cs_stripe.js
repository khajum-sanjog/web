$(document).ready(function(){const i=$("meta[name='publishable_key']").attr("content"),l=Stripe(i),r=l.elements(),p=$("meta[name='final_amt']").attr("content"),m=$("meta[name='store']").attr("content"),d=r.create("cardNumber",{placeholder:"**** **** **** ****"}),u=r.create("cardExpiry"),y=r.create("cardCvc"),c=$("#google_pay_container");d.mount("#card-element"),u.mount("#card-expiry"),y.mount("#card-cvc"),$("#btnSubmit").click(function(o){o.preventDefault();const e=$(this),s=$("#btnSpinner"),n=$("#btnText");e.prop("disabled",!0).addClass("opacity-70 cursor-not-allowed"),n.text("Processing..."),s.removeClass("hidden"),l.createToken(d).then(t=>{if(t.error){const a=JSON.stringify({status:"error",message:t.error.message});document.title=a,console.log(t.error),e.prop("disabled",!1).removeClass("opacity-70 cursor-not-allowed"),n.text("PAY NOW"),s.addClass("hidden")}else{const a=JSON.stringify({status:"success",data:{token:btoa(t.token.id)}});document.title=a}})}),c.length&&f();function f(){const e=new google.payments.api.PaymentsClient({environment:"TEST"}).createButton({buttonColor:"default",buttonType:"pay",buttonRadius:5,buttonSizeMode:"fill",onClick:b});c.find("button").length===0?c.empty().append(e):console.log("Google Pay button already exists")}function C(){return{apiVersion:2,apiVersionMinor:0,allowedPaymentMethods:[{type:"CARD",parameters:{allowedAuthMethods:["PAN_ONLY","CRYPTOGRAM_3DS"],allowedCardNetworks:["VISA","MASTERCARD","AMEX","DISCOVER","INTERAC","JCB"]},tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:{gateway:"stripe","stripe:version":"2020-08-27","stripe:publishableKey":i}}}],transactionInfo:{totalPriceStatus:"FINAL",totalPrice:p,currencyCode:"USD",countryCode:"US"},merchantInfo:{merchantName:m}}}async function b(o){o&&o.preventDefault();const e=C(),s=new google.payments.api.PaymentsClient({environment:"TEST"});try{const n=await s.loadPaymentData(e),t=JSON.parse(n.paymentMethodData.tokenizationData.token);if(t){const a=JSON.stringify({status:"success",data:{token:btoa(t.id)}});document.title=a}}catch(n){console.info(n)}}});
